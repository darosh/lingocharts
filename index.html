<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>LingoCharts!</title>
    <style>
        @font-face {
            font-family: 'icomoon';
            src: url('./assets/fonts/icomoon.eot?nel85w');
            src: url('./assets/fonts/icomoon.eot?nel85w#iefix') format('embedded-opentype'),
            url('data:application/font-woff;base64,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') format('woff'),
            url('./assets/fonts/icomoon.ttf?nel85w') format('truetype'),
            url('./assets/fonts/icomoon.svg?nel85w#icomoon') format('svg');
            font-weight: normal;
            font-style: normal;
        }

        [class^="icon-"], [class*=" icon-"] {
            /* use !important to prevent issues with browser extensions that change fonts */
            font-family: 'icomoon' !important;
            speak: none;
            font-style: normal;
            font-weight: normal;
            font-variant: normal;
            text-transform: none;
            line-height: 1;

            /* Better Font Rendering =========== */
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .icon-circle:before {
            content: "\e900";
        }

        body:after {
            font-family: icomoon;
            content: "\e900";
            display: none;
        }

        .icon-chevron-right:before {
            content: "\e901";
        }

        .icon-chevron-down:before {
            content: "\e903";
        }

        .icon-external-link:before {
            content: "\e905";
        }

        .icon-wikipedia-w:before {
            content: "\e906";
            position: relative;
            top: 2px;
        }

        a.icon-wikipedia-w, a.icon-wikipedia-w:visited {
            text-decoration: none;
            color: rgba(0, 0, 0, .87);
        }

        body {
            font-family: sans-serif;
            margin: 40px;
            color: rgba(0, 0, 0, .87);
            min-width: 1040px;
        }

        body, p, ul, li, td, th {
            font-size: 16px;
        }

        a {
            color: #1a0dab;
            white-space: nowrap;
            word-break: keep-all;
        }

        a:visited {
            color: #609;
        }

        hr {
            border: 0;
            background: #e0e0e0;
            height: 1px;
            margin: 40px 0;
        }

        h1, h2, h3 {
            padding: 2px 6px;
        }

        h3 > a, h3 > a:visited,
        h2 > a, h2 > a:visited,
        h1 > a, h1 > a:visited {
            text-decoration: none;
            color: rgba(0, 0, 0, .87);
        }

        h3 > a:hover, h2 > a:hover, h1 > a:hover {
            text-decoration: underline;
        }

        p {
            padding: 2px 8px;
        }

        tr > * {
            text-align: left;
            padding: 0 8px;
            line-height: 24px;
        }

        table {
            border-collapse: collapse;
        }

        .merged {
            border-bottom: 2px solid transparent;
        }

        tr:not(:last-child) > *,
        thead > tr > * {
            border-bottom: 1px solid #e0e0e0;
        }

        tbody > tr:hover > * {
            background-color: #f4f4f4;
        }

        .expanded + a {
            background: #d0ffff;
        }

        tbody > tr:target > *, h3:target, h2:target, a:target {
            background-color: #ffffc0;
            outline: none;
        }

        .right {
            text-align: right;
        }

        .bold {
            font-weight: bold;
        }

        .double {
            border-bottom: 3px double black;
        }

        .single {
            border-bottom: 1px solid black;
        }

        .chars {
            font-size: 14px;
            line-height: 16px;
            word-spacing: -1px;
        }

        .nowrap {
            white-space: nowrap;
            word-break: keep-all;
        }

        .sample {
            font-size: 20px;
        }

        a.noline {
            text-decoration: none;
            color: rgba(0, 0, 0, 0.87);
        }

        a:not('.noline') {
            text-decoration: underline;
            cursor: pointer;
        }

        .click {
            cursor: pointer;
        }

        .click:hover {
            text-decoration: underline;
        }

        a.glot, a.eth {
            text-decoration: none;
            font-weight: bold;
            color: rgba(0, 0, 0, 0.87);
            vertical-align: inherit;
        }

        .glot, .eth {
            width: 20px;
            height: 20px;
            display: inline-block;
            text-align: center;
        }

        .glot:after {
            background-color: rgba(0, 0, 0, 0.87);
            color: #fff;
            padding: 0 2px;
            content: '\0D17';
        }

        .eth:after {
            padding: 0 4px;
            background-color: #006599;
            color: #fff;
            content: 'E';
        }

        .family {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .family li {
            padding: 0 0 0 10px;
            margin: 0 0 0 12px;
        }

        .tree {
            line-height: 22px;
        }

        .tree li {
            border-left: 1px solid #e0e0e0;
        }

        .expander {
            cursor: pointer;
            line-height: 20px;
            width: 22px;
            height: 22px;
            display: inline-block;
        }

        .expander:after {
            font-family: icomoon;
            content: '\e901';
            position: relative;
            top: 2px;
            left: 4px;
        }

        .expander.expanded:after {
            content: '\e903';
        }

        .bullet {
            width: 22px;
            height: 22px;
            display: inline-block;
            text-align: center;
        }

        .bullet:after {
            font-family: icomoon;
            content: '\e900';
            line-height: 20px;
            position: relative;
            top: 1px;
            left: 1px;
        }

        [v-cloak] {
            display: none;
        }

        [target="_blank"]:not(.icon):after {
            content: ' \e905';
            font-family: icomoon;
            font-style: normal;
        }

        .no-bold-th-body tbody th {
            font-weight: normal;
            font-style: italic;
        }

        .items {
            font-weight: normal;
            font-size: 16px;
        }
    </style>
</head>
<body>
<script id="template-family" type="text/html">
    <ul v-if="nd && nd.id" class="family">
        <span v-if="nd.depth !== 0 && nd.children" @click="expanded = !expanded"
              :class="{expander: true, expanded: expanded}"></span>
        <span v-else-if="(nd.depth > 0) && !nd.children" class="bullet"></span>
        <a :href="'#family-' + nd.id" :id="'family-' + nd.id">
            <b v-if="nd.depth === 1">{{nd.data.data.name}}</b>
            <span v-else-if="nd.data && nd.data.data">{{nd.data.data.name}}</span>
        </a>
        <span v-if="nd.depth && nd.children">({{nd.leaves().length}})</span>
        <a v-if="(expanded || !nd.children) && nd.depth > 0"
           :href="'http://glottolog.org/resource/languoid/id/' + nd.data.id"
           target="_blank" class="icon glot"></a>
        <a v-if="(expanded || !nd.children) && nd.data && nd.data.data && nd.data.data.iso3"
           :href="'https://www.ethnologue.com/language/' + nd.data.data.iso3" target="_blank" class="icon eth"></a>
        <a v-if="(expanded || !nd.children) && nd.data && nd.data.data && nd.data.data.name"
           :href="'https://en.wikipedia.org/wiki/' + nd.data.data.name + (!nd.children ? ' language' : '')"
           target="_blank" class="icon icon-wikipedia-w"></a>
        <a v-if="(expanded || !nd.children) && nd.data && nd.data.data && nd.data.data.iso23"
           :href="'#language-' + nd.data.data.iso23">{{nd.data.data.iso23}}</a>
        <li v-for="i in nd.children" :style="{display: (expanded || nd.depth === 0) ? null : 'none'}">
            <family :node="i" class="tree"></family>
        </li>
    </ul>
</script>
<div id="app">
    <h1 id="contents"><a href="#contents">LingoCharts!</a></h1>
    <p>A language related data and charts. <br><i>Under construction.</i></p>

    <p v-if="!data"><i>Loading&hellip;</i></p>

    <div v-if="data" v-cloak>
        <ul>
            <li>
                Maps
                <ol>
                    <li><a href="#map">Map</a></li>
                    <li><a href="#map-population">Population</a></li>
                    <li><a href="#map-literacy">Literacy</a></li>
                    <li><a href="#map-population-literacy">Population &times; literacy</a></li>
                    <li><a href="#map-population-illiteracy">Population &times; illiteracy</a></li>
                    <li><a href="#map-gdp">GDP</a></li>
                    <li><a href="#map-gdp-capita">GDP / capita</a></li>
                    <li><a href="#map-internet">Internet</a></li>
                    <li><a href="#map-mobile">Mobile</a></li>
                    <li><a href="#map-languages">Languages</a></li>
                    <li><a href="#map-regions">Regions</a></li>
                    <li><a href="#map-un">United Nations</a></li>
                    <li><a href="#map-eu">European Union</a></li>
                    <li><a href="#map-ez">Eurozone</a></li>
                    <li><a href="#map-419">Latin America</a></li>
                    <li><a href="#map-flag">Flag color</a></li>
                </ol>
            </li>
            <li>
                Tables
                <ol>
                    <li><a href="#countries">Countries</a></li>
                    <li><a href="#languages">Languages</a></li>
                    <li><a href="#scripts">Scripts</a></li>
                    <li><a href="#numbers">Numbers</a></li>
                    <li><a href="#families">Families</a></li>
                    <li><a href="#characters">Characters</a></li>
                    <li><a href="#groups">Groups</a></li>
                    <li><a href="#plurals">Plurals</a></li>
                    <li><a href="#ordinals">Ordinals</a></li>
                </ol>
            </li>
            <li>
                About
                <ul>
                    <li><a href="#notes">Notes</a></li>
                    <li><a href="#codes">Codes</a></li>
                    <li><a href="#links">Links</a></li>
                    <li><a href="#source-code">Source code</a></li>
                    <li><a href="#data-sources">Data sources</a></li>
                </ul>
            </li>
        </ul>

        <hr>
        <h2 id="map"><a href="#map">Map</a></h2>
        <app-map :value="d => config.data.map[d.id] ? config.data.map[d.id].color : 0"
                 :extent="d3.range(8)"
                 :scale="d3.scaleOrdinal()"
                 :color="d3.merge([['#000'], d3.schemePastel2.slice(0,7)])"></app-map>

        <hr>
        <h2 id="map-population"><a href="#map-population">Population</a></h2>
        <app-map field="population"></app-map>

        <hr>
        <h2 id="map-literacy"><a href="#map-literacy">Literacy</a></h2>
        <app-map :scale="d3.scaleLinear()"
                 field="literacy"></app-map>

        <hr>
        <h2 id="map-population-literacy"><a href="#map-population-literacy">Population &times; literacy</a></h2>
        <app-map
                :value="d => config.data.country[d.id].population * config.data.country[d.id].literacy / 100"></app-map>

        <hr>
        <h2 id="map-population-illiteracy"><a href="#map-population-illiteracy">Population &times; illiteracy</a></h2>
        <app-map :value="d => config.data.country[d.id].population * (100 - config.data.country[d.id].literacy) / 100"
                 :scale="d3.scaleLinear()"
                 :color="t => d3.interpolateRdYlGn(1-t)"></app-map>

        <hr>
        <h2 id="map-gdp"><a href="#map-gdp">GDP</a></h2>
        <app-map field="gdp"></app-map>

        <hr>
        <h2 id="map-gdp-capita"><a href="#map-gdp-capita">GDP / capita</a></h2>
        <app-map :value="d => config.data.country[d.id].gdp / config.data.country[d.id].population"></app-map>

        <hr>
        <h2 id="map-internet"><a href="#map-internet">Internet</a></h2>
        <app-map field="net"
                 :scale="d3.scaleLinear()"></app-map>

        <hr>
        <h2 id="map-mobile"><a href="#map-mobile">Mobile</a></h2>
        <app-map field="cell"></app-map>

        <hr>
        <h2 id="map-languages"><a href="#map-languages">Languages</a></h2>
        <app-map :value="d => Object.keys(config.data.country[d.id].language || {}).length"
                 :scale="d3.scaleLinear()"
                 :color="t => d3.interpolateRdYlGn(1-t)"></app-map>

        <hr>
        <h2 id="map-regions"><a href="#map-regions">Regions</a></h2>
        <app-map multi="_groupValue"></app-map>

        <hr>
        <h2 id="map-un"><a href="#map-un">United Nations</a></h2>
        <app-map
                :computed="d => config.data.group.UN.contains.indexOf(d.id) === -1 ? '#ccc' : d3.interpolateRdYlGn(1)"></app-map>

        <hr>
        <h2 id="map-eu"><a href="#map-eu">European Union</a></h2>
        <app-map
                :computed="d => config.data.group.EU.contains.indexOf(d.id) === -1 ? '#ccc' : d3.interpolateRdYlGn(1)"></app-map>

        <hr>
        <h2 id="map-ez"><a href="#map-ez">Eurozone</a></h2>
        <app-map
                :computed="d => config.data.group.EZ.contains.indexOf(d.id) === -1 ? '#ccc' : d3.interpolateRdYlGn(1)"></app-map>

        <hr>
        <h2 id="map-419"><a href="#map-419">Latin America</a></h2>
        <app-map
                :computed="d => !config.data.group['419'].contains.filter(e => config.data.group[e].contains.indexOf(d.id) !== -1).length ? '#ccc' : d3.interpolateRdYlGn(1)"></app-map>

        <hr>
        <h2 id="map-flag"><a href="#map-flag">Flag color</a></h2>
        <app-map :computed="d => '#' + config.data.country[d.id].color"></app-map>

        <hr>
        <sortable :list="data.country">
            <template slot="table" scope="props">
                <h2 id="countries"><a href="#countries">Countries</a> <span
                        class="items">({{props.list.length}})</span>
                </h2>
                <table style="margin-left: 3px">
                    <thead>
                    <tr>
                        <th class="click" @click="props.sort('color')">Flag</th>
                        <th class="click" @click="props.sort('id')">Code</th>
                        <th class="click" @click="props.sort('name')" style="width: 180px">Name</th>
                        <th>Wiki</th>
                        <th class="click" @click="props.sort('likely')">Likely</th>
                        <th class="click" @click="props.sort('population', true)">Population</th>
                        <th class="click" @click="props.sort('literacy', true)">Literacy</th>
                        <th class="click" @click="props.sort('gdp', true)">GDP</th>
                        <th class="click" @click="props.sort('net', true)">Internet</th>
                        <th class="click" @click="props.sort('cell', true)">Mobile</th>
                        <th class="click" @click="props.sort('currency')">Currency</th>
                        <th class="nowrap">Language (population / literacy)
                            <br>
                            <small style="font-weight: normal">
                                <span>de facto official</span>,
                                <span class="single">official regional</span>,
                                <span class="double">official</span>,
                                <b>CLDR</b>
                            </small>
                        </th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr v-for="i in props.list" :id="'country-' + i.id" :key="i.id">
                        <td :style="{'border-left': '3px solid #' + i.color}">
                            <flag :code="i.id" style="width: 32px; height: 32px"></flag>
                        </td>
                        <td><a :href="'#country-' + i.id">{{i.id}}</a></td>
                        <td><b>{{i.name}}</b></td>
                        <td><a class="icon icon-wikipedia-w" :href="'https://en.wikipedia.org/wiki/' + i.name"
                               target="_blank"></a></td>
                        <td class="nowrap">{{i.likely}}</td>
                        <td class="right">{{i.population | number}}</td>
                        <td class="right">{{i.literacy | percent}}</td>
                        <td class="right">{{i.gdp | money}}</td>
                        <td class="right">{{i.net | percent}}</td>
                        <td class="right">{{i.cell | percent}}</td>
                        <td>{{i.currency}}</td>
                        <td class="nowrap">
                            <div v-for="(i, k) in i.language"><a :href="'#language-' + k"
                                                                 :class="{noline: 1, double: i.status === 0, single: i.status === 1, bold: i.cldr}">{{k}}</a>
                                ({{i.percent}}%{{i.literacy ? (' / ' + i.literacy) + '%' : ''}})
                            </div>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </template>
        </sortable>

        <hr>
        <sortable :list="data.language">
            <template slot="table" scope="props">
                <h2 id="languages"><a href="#languages">Languages</a> <span
                        class="items">({{props.list.length}})</span></h2>

                <table>
                    <thead>
                    <tr>
                        <th class="click" @click="props.sort('id')">Code</th>
                        <th class="click" @click="props.sort('name')">Name</th>
                        <th>Wiki</th>
                        <th class="click" @click="props.sort('iso')">ISO</th>
                        <th class="click" @click="props.sort('gl')">Glottolog</th>
                        <th class="click" @click="props.sort('likely')">Likely</th>
                        <th class="click" @click="props.sort('cldr', true)">CLDR</th>
                        <th class="click" @click="props.sort('population', true)">Population</th>
                        <th class="click" @click="props.sort('literacy', true)">Literacy</th>
                        <th>Plural</th>
                        <th></th>
                        <th>Ordinal</th>
                        <th></th>
                        <th class="click" @click="props.sort('family')">Family</th>
                        <th class="click" @click="props.sort('num')">Numbers</th>
                        <th class="click" @click="props.sort('script')">Script</th>
                        <th>RTL</th>
                        <th class="click" @click="props.sort('quot', true)">Quotes</th>
                        <th>Sample</th>
                        <th class="click" @click="props.sort(i=>(i.chars>=0)?i.script+(i.chars+1):'')">Characters</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr v-for="i in props.list" :id="'language-' + i.id" :key="i.id">
                        <td class="nowrap"><a :href="'#language-' + i.id">{{i.id}}</a></td>
                        <td><b>{{i.name}}</b></td>
                        <td>
                            <a :href="'https://en.wikipedia.org/wiki/' + i.name + ' language'" target="_blank"
                               class="icon icon-wikipedia-w"></a>
                        </td>
                        <td><a :href="'http://www-01.sil.org/iso639-3/documentation.asp?id=' + i.iso3"
                               target="_blank">{{i.iso3}}</a></td>
                        <td><a :href="'http://glottolog.org/resource/languoid/id/' + i.gl" target="_blank">{{i.gl}}</a>
                        </td>
                        <td class="nowrap">{{i.likely}}</td>
                        <td>{{i.cldr | yes('CLDR')}}</td>
                        <td class="right">{{i.population | number}}</td>
                        <td class="right">{{i.literacy | percent}}</td>
                        <td class="right"><span v-if="i.plural >= 0">{{data.plural[i.plural].forms.length}}</span></td>
                        <td><a v-if="i.plural >= 0" :href="'#plural-'+(i.plural + 1)">p{{i.plural + 1}}</a></td>
                        <td class="right"><span v-if="i.ordinal >= 0">{{data.ordinal[i.ordinal].forms.length}}</span>
                        </td>
                        <td><a v-if="i.ordinal >= 0" :href="'#ordinal-'+(i.ordinal + 1)">o{{i.ordinal + 1}}</a></td>
                        <td class="nowrap"><a :href="'#family-' + i.gl">{{data.family[i.family].name}}</a></td>
                        <td><a :href="'#number-'+i.num">{{i.num}}</a></td>
                        <td><a :href="'#script-'+i.script" v-if="data.script[i.script]">{{i.script}}</a><span v-else>{{i.script}}</span>
                        </td>
                        <td><span v-if="data.script[i.script]">{{data.script[i.script].rtl | yes('RTL')}}</span></td>
                        <td class="sample"><span v-if="data.quot[i.quot]">{{data.quot[i.quot]}}</span></td>
                        <td class="sample"><span v-if="data.script[i.script]">{{data.script[i.script].sample}}</span>
                        </td>
                        <td><a v-if="i.chars >= 0" :href="'#characters-' + i.script + (i.chars + 1) + i.id">{{i.script +
                            (i.chars +1)}}</a></td>
                    </tr>
                    </tbody>
                </table>
            </template>
        </sortable>

        <hr>
        <sortable :list="data.script">
            <template slot="table" scope="props">
                <h2 id="scripts"><a href="#scripts">Scripts</a> <span
                        class="items">({{props.list.length}})</span></h2>

                <table>
                    <thead>
                    <tr>
                        <th>Sample</th>
                        <th>Code</th>
                        <th>Name</th>
                        <th>Wiki</th>
                        <th>RTL</th>
                        <th>Cased</th>
                        <th>Line break letters</th>
                        <th>IME <a href="https://en.wikipedia.org/wiki/Input_method" target="_blank"
                                   class="icon icon-wikipedia-w"></a></th>
                        <th>Density</th>
                        <th>Characters</th>
                        <th>Origin</th>
                        <th>Language</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr v-for="i in props.list" :id="'script-' + i.id">
                        <td class="sample">{{i.sample}}</td>
                        <td><a :href="'#script-' + i.id">{{i.id}}</a></td>
                        <td><b>{{i.name}}</b></td>
                        <td>
                            <a :href="'https://en.wikipedia.org/wiki/' + i.name + ' script'" target="_blank"
                               class="icon icon-wikipedia-w"></a>
                        </td>
                        <td>{{i.rtl | yes('RTL')}}</td>
                        <td>{{i.cased | yes('cased')}}</td>
                        <td>{{i.lbl | yes('LBL')}}</td>
                        <td>{{i.ime | yes('IME')}}</td>
                        <td class="right">{{i.density}}</td>
                        <td class="right" v-if="i.chars">{{i.chars | number}}</td>
                        <td class="right" v-else>?</td>
                        <td><a :href="'#country-'+i.country">{{i.country}}</a></td>
                        <td><a :href="'#language-'+i.language">{{i.language}}</a></td>
                    </tr>
                    </tbody>
                </table>
            </template>
        </sortable>

        <hr>
        <sortable :list="data.num">
            <template slot="table" scope="props">
                <h2 id="numbers"><a href="#numbers">Numbers</a> <span
                        class="items">({{props.list.length}})</span></h2>

                <table>
                    <thead>
                    <th>Sample</th>
                    <th>Code</th>
                    <th>Name</th>
                    <th>Type</th>
                    <th>Digits</th>
                    </thead>
                    <tbody>
                    <tr v-for="i in props.list" :id="'number-' + i.id">
                        <td class="sample">{{i.digits[8]}}</td>
                        <td><a :href="'#number-' + i.id">{{i.id}}</a></td>
                        <td><b>{{i.name}}</b></td>
                        <td>{{i.type}}</td>
                        <td>{{i.digits}}</td>
                    </tr>
                    </tbody>
                </table>
            </template>
        </sortable>

        <hr>
        <h2 id="families"><a href="#families">Families</a> <span
                class="items">({{items(data.family)}})</span></h2>

        <family :db="data" class="nowrap"></family>

        <hr>
        <sortable :list="data.language" :filter="i=>i.chars>=0">
            <template slot="table" scope="props">
                <h2 id="characters"><a href="#characters">Characters</a> <span
                        class="items">({{props.list.length}})</span></h2>
                <table>
                    <thead>
                    <tr>
                        <th>Id</th>
                        <th>Language</th>
                        <th>Name</th>
                        <th>Population</th>
                        <th>Literacy</th>
                        <th>Numbers</th>
                        <th>Script</th>
                        <th>RTL</th>
                        <th>Quotes</th>
                        <th>Count</th>
                        <th style="min-width: 360px">Characters</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr v-for="i in props.list" :id="'characters-' + i.script + (i.chars + 1) + i.id">
                        <td>{{i.script + (i.chars + 1)}}</td>
                        <td class="nowrap"><a :href="'#language-' + i.id">{{i.id}}</a></td>
                        <td><b>{{i.name}}</b></td>
                        <td class="right">{{i.population | number}}</td>
                        <td class="right">{{i.literacy | percent}}</td>
                        <td><a :href="'#number-'+i.num">{{i.num}}</a></td>
                        <td><a :href="'#script-'+i.script"
                               v-if="data.script[i.script]">{{data.script[i.script].name}}</a></td>
                        <td><span v-if="data.script[i.script]">{{data.script[i.script].rtl | yes('RTL')}}</span></td>
                        <td class="sample"><span v-if="data.quot[i.quot]">{{data.quot[i.quot]}}</span></td>
                        <td class="right"><span
                                v-if="i.chars >= 0">{{data.char[i.script][i.chars].count | number}}</span></td>
                        <td>
                            <a class="expander" :class="{expanded: i.$chars}"
                               v-if="i.$chars || !i.$chars && (i.chars >= 0 && data.char[i.script][i.chars].chars.length > 600)"
                               @click="Vue.set(i, '$chars', !i.$chars)"></a>
                            <span class="chars" v-if="i.chars >= 0"
                                  v-text="data.char[i.script][i.chars].chars.substr(0, !i.$chars ? 600: undefined)"></span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </template>
        </sortable>

        <hr>
        <h2 id="groups"><a href="#groups">Groups</a></h2>

        <div v-for="(i, k) in groups">
            <h3 :id="'group-' + k">
                <a :href="'#group-' + k"><span style="font-weight: normal">{{k}}</span> {{data.group[k].name}}</a>
                <span
                        style="font-weight: normal; font-size: 16px">({{groups[k].items}})</span>
                <flag :code="k"
                      style="width: 32px; height: 32px; display: inline-block; position: relative; top: 10px; margin: -16px 0"></flag>
            </h3>
            <table class="merged">
                <tbody>
                <tr v-for="i in groups[k]" v-if="i[i.length -1]">
                    <td v-for="j in i" :rowspan="j.span" v-if="j && j.span" :class="{nowrap: data.group[j.id]}"
                        :style="{'min-width': !data.group[j.id] ? '480px' : null}">
                        <a :href="'#group-' + k + '-' + j.id" v-if="!j.data.group" :id="'group-' + k + '-' + j.id"
                           v-if="!j.data.group">{{j.id}}</a>
                        <b v-if="data.group[j.id]">{{data.group[j.id].name}}</b>
                        <span v-if="data.group[j.id]">({{j.items}})</span>
                        <span v-if="j.data.group" @click="Vue.set(j, 'expanded', !j.expanded)"
                              :class="{expander: true, expanded: j.expanded}"></span>
                        <span v-for="(l, n) in j.data.group"><a :href="'#country-' + l">{{l}}</a><span
                                v-show="j.expanded"> {{data.country[l].name}}</span><span
                                v-if="(n + 1) < j.data.group.length">, </span></span>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <hr>
        <h2 id="plurals"><a href="#plurals">Plurals</a></h2>

        <table>
            <thead>
            <tr>
                <th>Id</th>
                <th>Count</th>
                <th>Forms</th>
            </tr>
            </thead>
            <tbody>
            <tr v-for="(i, k) in data.plural" :id="'plural-' + (k + 1)">
                <td><a :href="'#plural-' + (k + 1)">p{{k + 1}}</a></td>
                <td>{{i.forms.length}}</td>
                <td><span v-for="(j, k) in i.forms">{{data.form[j]}}<span
                        v-if="(k + 1) < i.forms.length">, </span></span>
                </td>
            </tr>
            </tbody>
        </table>

        <hr>
        <h2 id="ordinals"><a href="#ordinals">Ordinals</a></h2>

        <table>
            <thead>
            <tr>
                <th>Id</th>
                <th>Count</th>
                <th>Forms</th>
            </tr>
            </thead>
            <tbody>
            <tr v-for="(i, k) in data.ordinal" :id="'ordinal-' + (k + 1)">
                <td><a :href="'#ordinal-' + (k + 1)">o{{k + 1}}</a></td>
                <td>{{i.forms.length}}</td>
                <td><span v-for="(j, k) in i.forms">{{data.form[j]}}<span
                        v-if="(k + 1) < i.forms.length">, </span></span>
                </td>
            </tr>
            </tbody>
        </table>

        <hr>
        <h2 id="notes"><a href="#notes">Notes</a></h2>

        <p>Most data come from CLDR see <a href="#data-sources">Data sources</a> section.</p>
        <p>Only languages with <i class="double">official</i>, <i class="single">regional official</i> and <i>de
            facto
            official</i> status are included.</p>

        <hr>
        <h2 id="codes"><a href="#codes">Codes</a></h2>

        <p>Used in <b>language</b>-<b>Script</b>-<b>COUNTRY</b> form.</p>

        <table class="merged">
            <thead>
            <tr>
                <th>Type</th>
                <th>Iso</th>
                <th>Case</th>
                <th>Letters</th>
                <th>Sample</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td rowspan="2">Language</td>
                <td><a href="https://en.wikipedia.org/wiki/ISO_639-1" target="_blank">ISO 639-1</a></td>
                <td>lower</td>
                <td class="right">2</td>
                <td><a href="#language-cs">cs</a></td>
            </tr>
            <tr>
                <td><a href="https://en.wikipedia.org/wiki/ISO_639-3" target="_blank">ISO 639-3</a></td>
                <td>lower</td>
                <td class="right">3</td>
                <td><a href="http://www-01.sil.org/iso639-3/documentation.asp?id=ces" target="_blank">ces</a></td>
            </tr>
            <tr>
                <td>Script</td>
                <td><a href="https://en.wikipedia.org/wiki/ISO_15924" target="_blank">ISO 15924</a></td>
                <td>Capitalized</td>
                <td class="right">4</td>
                <td><a href="#script-Latn">Latn</a></td>
            </tr>
            <tr>
                <td>Country</td>
                <td><a href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2" target="_blank">ISO 3166-1
                    alpha-2</a>
                </td>
                <td>UPPER</td>
                <td class="right">2</td>
                <td><a href="#country-CZ">CZ</a></td>
            </tr>
            </tbody>
        </table>

        <hr>
        <h2 id="links"><a href="#links">Links</a></h2>

        <table class="merged">
            <thead>
            <tr>
                <th>Source</th>
                <th>Type</th>
                <th>Samples</th>
                <th>Notes</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td>Wikipedia</td>
                <td>external</td>
                <td><a href="https://en.wikipedia.org/wiki/Czech%20language" target="_blank"
                       class="icon icon-wikipedia-w"></a></td>
                <td>Search links made from names. <br><b>Warning:</b> may be misleading!</td>
            </tr>
            <tr>
                <td rowspan="2">Glottolog</td>
                <td rowspan="2">external</td>
                <td><a href="http://glottolog.org/resource/languoid/id/czec1258" target="_blank">czec1258</a></td>
                <td rowspan="2"></td>
            </tr>
            <tr>
                <td><a href="http://glottolog.org/resource/languoid/id/czec1258" target="_blank" class="glot icon"
                       style="margin-top: -5px;"></a>
                </td>
            </tr>
            <tr>
                <td>ISO 639-3</td>
                <td>external</td>
                <td><a href="http://www-01.sil.org/iso639-3/documentation.asp?id=ces" target="_blank">ces</a></td>
                <td></td>
            </tr>
            <tr>
                <td>Ethnologue</td>
                <td>external</td>
                <td><a href="https://www.ethnologue.com/language/ces" target="_blank" class="eth icon"
                       style="margin-top: -5px;"></a></td>
                <td></td>
            </tr>
            <tr>
                <td rowspan="3"><i>this application</i></td>
                <td rowspan="2">internal</td>
                <td><a href="#language-cs">cs</a></td>
                <td rowspan="3"></td>
            </tr>
            <tr>
                <td><a href="#language-cs" class="noline double bold">cs</a></td>
            </tr>
            <tr>
                <td>external</td>
                <td><a href="http://cldr.unicode.org/" target="_blank">http://cldr.unicode.org/</a></td>
            </tr>
            </tbody>
        </table>

        <hr>
        <h2 id="source-code"><a href="#source-code">Source code</a></h2>
        <p>
            Releases under <a :href="config.repo + 'blob/master/LICENSE'" target="_blank">MIT license</a> on GitHub:
            <a
                    href="https://github.com/darosh/lingocharts"
                    target="_blank">https://github.com/darosh/lingocharts</a>.
        </p>
        <p>
            Live application: <a :href="config.url" target="_blank">{{config.url}}</a>.
        </p>

        <h3 id="source-code-data"><a href="#source-code-data">Data</a></h3>

        <p>Available in <a href="https://en.wikipedia.org/wiki/JSON" target="_blank">JSON</a> and <a
                href="https://en.wikipedia.org/wiki/Tab-separated_values" target="_blank">TSV</a> format. <b>Bold
            items</b> in table bellow are used in this application. Served via <a
                href="https://help.github.com/categories/github-pages-basics/" target="_blank">GitHub Pages</a>
            directly from master branch.</p>

        <table class="no-bold-th-body">
            <thead>
            <tr>
                <th>Source</th>
                <th>JSON</th>
                <th>TSV</th>
                <th>SVG</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <th><a :href="config.repo +  'blob/master/data/index.json'" target="_blank">index</a></th>
                <td><a :href="'./data/index.json'" target="_blank"><b>index.json</b></a></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <th><a :href="config.repo +  'blob/master/data/map.topo.json'" target="_blank">map.topo</a></th>
                <td><a :href="'./data/map.topo.json'" target="_blank"><b>map.topo.json</b></a></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <th><a :href="config.repo +  'blob/master/data/flags.svg'" target="_blank">flags</a></th>
                <td></td>
                <td></td>
                <td><a :href="'./data/flags.svg'" target="_blank"><b>flags.svg</b></a></td>
            </tr>
            <tr v-for="(i, k) in data">
                <th><a :href="config.repo +  'blob/master/data/json/' + k + '.json'" target="_blank">{{k}}</a></th>
                <td><a :href="'./data/json/' + k + '.json'" target="_blank">{{k}}.json</a></td>
                <td><a :href="'./data/tsv/' + k + '.tsv'" target="_blank">{{k}}.tsv</a></td>
                <td></td>
            </tr>
            </tbody>
        </table>

        <hr>
        <h2 id="data-sources"><a href="#data-sources">Data sources</a></h2>

        <div v-for="(i, k) in data.version">
            <h3 :id="'data-source-' + k"><a :href="'#data-source-' + k">{{i.name}}</a></h3>
            <p v-if="i.notes">{{i.notes}}</p>
            <ul>
                <li>version: {{i.version}} {{i.build}}</li>
                <li>home: <a :href="i.home" target="_blank">{{i.home}}</a></li>
                <li v-if="i.source">source: <a :href="i.source" target="_blank">{{i.source}}</a></li>
                <li v-if="i.api">api:
                    <ul>
                        <li v-for="j in i.api"><a :href="j" target="_blank">{{j}}</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</div>
<script src="//unpkg.com/d3@4.7.4/build/d3.min.js"></script>
<script src="//unpkg.com/d3-scale-chromatic@1.1.1/build/d3-scale-chromatic.min.js"></script>
<script src="//unpkg.com/topojson-client@3.0.0/dist/topojson-client.min.js"></script>
<script src="//unpkg.com/vue@2.2.6/dist/vue.min.js"></script>
<!--<script src="//unpkg.com/vue@2.2.6/dist/vue.js"></script>-->
<script>
    var config = {
        url: 'https://darosh.github.io/lingocharts/',
        repo: 'https://github.com/darosh/lingocharts/',
        format: d3.format(','),
        money: d3.format(',.0f'),
        hash: ''
    };

    config.online = location.hostname === 'localhost'
        ? location.protocol + '//' + location.host + location.pathname.replace(/index\.html$/gi, '').replace(/\/$/, '') + '/'
        : config.url;

    config.multicolor = [
        d3.interpolateGreens,
        d3.interpolateGreys,
        d3.interpolatePurples,
        d3.interpolateOranges,
        d3.interpolateBlues,
        d3.interpolateReds
    ];

    Vue.filter('number', function (n) {
        return config.format(n);
    });

    Vue.filter('percent', function (n) {
        return isNaN(n) ? '' : (n + '%');
    });

    Vue.filter('money', function (n) {
        return isNaN(n) ? '' : ('$' + config.money(n));
    });

    Vue.filter('yes', function (v, t) {
        return v ? (t ? t : 'yes') : '';
    });

    Vue.component('flag', {
        template: '<div></div>',
        props: ['code'],
        mounted() {
            var f = getFlag(this.code, config.flags);

            if (f) {
                this.$el.appendChild(f);
            }
        }
    });

    Vue.component('sortable', {
        template: '<div><slot name="table" :list="sorted" :sort="sort"></slot></div>',
        props: ['list', 'filter'],
        data() {
            var l = Object.keys(this.list).map(k => (this.list[k].id = k, this.list[k]));

            if (this.filter) {
                l = l.filter(this.filter);
            }

            return {
                sorted: l
            }
        },
        methods: {
            sort(by, numeric) {
                if (numeric) {
                    this.sorted.sort((a, b) => val(a) - val(b));
                } else {
                    this.sorted.sort((a, b) => val(a).localeCompare(val(b)));
                }

                function val(a) {
                    var r = by.call ? by(a) : a[by];
                    return numeric ? isNaN(r) ? -Infinity : r : (r || '');
                }
            }
        }
    });

    Vue.component('family', {
        template: document.getElementById('template-family').innerHTML,
        props: ['db', 'node'],
        data(){
            return {
                expanded: false,
                config: config
            }
        },
        computed: {
            nd() {
                return this.node || d3.stratify()
                        .parentId(d => d.data && d.data.parent ? d.data.parent : d.id === 'root' ? null : 'root')
                        (d3.merge([Object.keys(this.db.family).map(k => ({
                            id: k,
                            expanded: false,
                            data: this.db.family[k]
                        })), [{id: 'root'}]]))
            }
        },
        watch: {
            'config.hash': function (newVal) {
                if (this.db && (newVal.indexOf('family-') > -1)) {
                    iter(this);

                    function iter(node) {
                        node.$children.forEach(c => {
                            c.expanded = false;
                            iter(c);
                        });
                    }
                }

                if (this.node && (newVal === ('family-' + this.node.id))) {
                    this.expanded = true;
                    var p = this;

                    while ((p = p.$parent) && p.$vnode && p.$vnode.componentOptions.tag === 'family') {
                        p.expanded = true;
                    }

                    Vue.nextTick(() => {
                        var u = location.href;
                        location.href = u;
                    });
                }
            }
        }
    });

    var width = 960;
    var height = 480;
    var legendMargin = 12;
    var legendHeight = 6 + 10 + legendMargin * 2;
    var add = 0;

    //    var clip = [[0, 960], [15, 390]];
    var clip = [[0, 960], [0, 480]];

    var simplify = d3.geoTransform({
        point: function (x, y) {
            this.stream.point(Math.round(x), Math.round(y));
        }
    });

    var projection = d3.geoEquirectangular()
        .clipExtent([[0, 0], [width, clip[1][1]]])
        .scale(height / Math.PI)
        .rotate([-10])
        .translate([width / 2, height / 2 - clip[1][0]])
        .precision(1);

    var path = d3.geoPath()
        .projection({
            stream: function (s) {
                return projection.stream(simplify.stream(s));
            }
        })
        //        .projection(projection)
        .pointRadius(2);

    var graticule = d3.geoGraticule();

    Vue.component('app-map', {
        template: '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g class="graticule"></g><g class="land"></g><g class="border"></g><g class="legend"></g><g class="frame"></g></svg>',
        props: ['color', 'value', 'scale', 'extent', 'field', 'computed', 'multi'],
        mounted(){
            var svg = d3.select(this.$el);
            svg.attr('width', width)
                .attr('height', clip[1][1] - clip[1][0] + legendHeight);
            var grat = svg.select('.graticule');
            grat.selectAll('path').data([graticule()])
                .enter()
                .append('path')
                .attr('d', path)
                .attr('fill', 'none')
                .attr('stroke-width', 0.5)
                .attr('stroke', '#ccc');

            var color;

            if (this.multi) {
                color = d => {
                    var t = config.data.country[d.id][this.multi];
                    return config.multicolor[t[0]](t[1] * 0.5 + 0.25);
                }
            } else if (this.computed) {
                color = this.computed;
            } else {
                var value = this.field ? d => config.data.country[d.id][this.field] : this.value;
                var extent = this.extent ? this.extent : d3.extent(Object.keys(config.data.country), k => value(config.data.country[k]));
                this.scale = this.scale || d3.scaleLog();
                this.color = this.color || (d => isNaN(d) ? '#fff' : d3.interpolateRdYlGn(d));
                var colorScale = this.scale.domain(extent).range(this.color.call ? [0, 1] : this.color);
                color = this.color.call ? d => this.color(colorScale(value(d))) : d => colorScale(value(d));
            }

            var hasBottomLegend = colorScale && extent.length === 2;
            svg.attr('height', clip[1][1] - clip[1][0] + (hasBottomLegend ? legendHeight : 0));

            var land = svg.select('.land');
            land.selectAll('a').data(config.land)
                .enter()
                .append('a')
                .attr('xlink:href', d => '#country-' + d.id)
                .append('path')
                .attr('title', d => d.id)
                .attr('d', path)
                .attr('fill', color);
            var border = svg.select('.border');
            border.selectAll('d').data([config.border])
                .enter()
                .append('path')
                .attr('d', path)
                .attr('fill', 'none')
                .attr('stroke', '#000')
                .attr('stroke-width', 0.5);

            var frameStroke = 0.5;
            var frame = svg.select('.frame');
            frame.selectAll('rect').data([0])
                .enter()
                .append('rect')
                .attr('x', frameStroke / 2)
                .attr('y', frameStroke / 2)
                .attr('width', width - frameStroke)
                .attr('height', height - frameStroke)
                .attr('fill', 'none')
                .attr('stroke', '#000')
                .attr('stroke-width', frameStroke);

            if (hasBottomLegend) {
                colorScale.range([0 + legendMargin, width - legendMargin]);
                var axis = d3.axisBottom(colorScale).ticks(7, '.0s');
                svg.select('.legend')
                    .attr('transform', 'translate(0, ' + (height + legendMargin) + ')')
                    .call(axis);
            }
        }
    });

    new Vue({
        el: '#app',
        data() {
            d3.queue()
                .defer(d3.json, './data/index.json')
                .defer(d3.json, './data/map.topo.json')
                .defer(d3.xml, './data/flags.svg')
                .await((err, data, map, flags) => {
                    config.flags = flags;
                    config.map = map;
                    config.data = data;
                    config.land = topojson.feature(map, map.objects.countries).features;
                    config.border = topojson.mesh(map, map.objects.countries);
                    this.data = data;

                    this.groups = {
                        '001': this.groupTable('001'),
                        '419': this.groupTable('419'),
                        EU: this.groupTable('EU'),
                        EZ: this.groupTable('EZ'),
                        UN: this.groupTable('UN')
                    };

                    this.addCountryGroup();

                    Vue.nextTick(function () {
                        var h = location.hash;
                        var u = location.href;

                        if (h.length > 1) {
                            var e = document.querySelector(h);

                            if (e) {
                                e.scrollIntoView();
                            }

                            location.href = u;
                        }

                        config.hash = h.substr(1);

                        window.addEventListener('hashchange', () => {
                            var h = location.hash;
                            config.hash = h.substr(1);
                            document.querySelector(h).scrollIntoView();
                        }, false);

                    });
                });

            return {
                config: config,
                data: null,
                map: null,
                groups: {}
            }
        },
        methods: {
            items(o) {
                return Array.isArray(o) ? o.length : Object.keys(o).length;
            },
            addCountryGroup () {
                config.data.group['001'].contains.forEach((c, i) => {
                    config.data.group[c].contains.forEach((d, j, a) => {
                        config.data.group[d].contains.forEach(e => {
                            config.data.country[e]._group = [c, d];
                            config.data.country[e]._groupValue = [i, j / (a.length - 1)];
                        });
                    });
                });
            },
            groupTable(code) {
                var a = [];

                iter(code, this.data);

                function iter(code, data, parent = null) {
                    a.push({
                        id: code,
                        parentId: parent
                    });

                    if (data.group[data.group[code].contains[0]]) {
                        (data.group[code] ? data.group[code].contains : []).forEach(d => {
                            iter(d, data, code);
                        });
                    } else {
                        a.push({
                            id: code + '-group',
                            parentId: code,
                            group: data.group[code].contains
                        });
                    }
                }

                a = d3.stratify()(a);

                var b = [];

                a.descendants().forEach(d => {
                    if (d.parent) {
                        var j = d.depth - 1;
                        b[j] = b[j] || [];
                        var l = d.leaves();
                        d.span = l.length;
                        d.items = 0;
                        d.expanded = false;
                        l.forEach(e => d.items += e.data.group.length);
                        b[j].push(d);
                    }
                });

                var c = [];
                var ii = [];
                b[b.length - 1].forEach((v, i) => {
                    b.forEach((v, j) => {
                        ii[j] = ii[j] || 0;
                        c[ii[j]] = c[ii[j]] || [];
                        c[ii[j]][j] = b[j][i];
                        ii[j] += b[j][i] ? b[j][i].span : 0;
                    });
                });

                c.items = 0;
                (a.children || []).forEach(e => c.items += e.items);

                return c;
            }
        }
    });

    function getFlag(iso, flags) {
        var node = flags.getElementById(iso);

        if (node) {
            node = node.cloneNode(true);
            node.removeAttribute('id');
            node.removeAttribute('transform');
            var svg = document.createElementNS(d3.namespaces.svg, 'svg');
            svg.setAttribute('width', '100%');
            svg.setAttribute('height', '100%');
            svg.setAttribute('viewBox', '0 0 64 64');
            svg.setAttribute('preserveAspectRatio', 'xMaxYMax');
            svg.appendChild(node);
            return svg;
        }
    }
</script>
</body>
</html>
